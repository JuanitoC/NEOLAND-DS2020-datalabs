DF['FI1'] <- ymd_hms(as.factor(DF['fecha_informe']))
library(tidyverse)
library(lubridate)
## Carga del fichero
DF <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
DF['FI1'] <- ymd_hms(as.factor(DF['fecha_informe']))
View(DF)
## DF['FI1'] <-
ymd_hms(as.factor(DF['fecha_informe']))
## DF['FI1'] <-
ymd_hms(as.factor(DF['fecha_informe'][1]))
## DF['FI1'] <-
DF['fecha_informe'][1]
## DF['FI1'] <-
DF['fecha_informe',1]
## DF['FI1'] <-
DF[1,'fecha_informe']
## DF['FI1'] <-
ymd_hms(DF[1,'fecha_informe'])
## DF['FI1'] <-
ymd_hms(DF['fecha_informe'])
## DF['FI1'] <-
ymd_hms(as.factor(DF['fecha_informe']))
DF <- DF%>% mutate(
FI1=ymd_hms(DF['fecha_informe']))
DF['fecha_informe']
DF <- DF%>% mutate(
FI1=ymd_hms(DF['fecha_informe']))
DF['FI1']
## Carga del fichero
DF <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
DF <- DF%>% mutate(
FI1=ymd_hms(DF['fecha_informe']))
DF['FI1'] <- as.Date(DF['fecha_informe'])
DF['FI1'] <- as.Date(DF['fecha_informe'])
DF <- DF%>% mutate(
FI1=ymd(DF['fecha_informe']))
ymd(DF['fecha_informe'])
ymd(DF[1,'fecha_informe'])
ymd(DF[1,'fecha_informe'])
ymd_hms(DF[1,'fecha_informe'])
date(DF[1,'fecha_informe'])
DF <- DF%>% mutate(
FI1=date(DF['fecha_informe']))
date(DF[1,'fecha_informe'])
date(DF['fecha_informe'])
date(as.vector(DF['fecha_informe']))
ncol(DF)
nrow(DF)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:ncol(DF)){
print(x)
}
View(DF)
View(DF)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:row(DF)){
print(x)
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
View(DF)
View(DF)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
print(x)
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
View(DF)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF['tasa_incidencia_acumulada_ultimos_14dias']
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
as.numeric(DF['tasa_incidencia_acumulada_ultimos_14dias'] )
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
as.double(DF['tasa_incidencia_acumulada_ultimos_14dias'])
library(tidyverse)
library(lubridate)
library(stringr)
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,',','.'))
## Carga del fichero
DF <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
## Carga del fichero
DF0 <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,',','.'))
## Carga del fichero
DF0 <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
DF0.info
View(DF0)
View(DF0)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,'.',','))
View(DF)
View(DF)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_activos_ultimos_14dias,',','.'))
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_activos_ultimos_14dias,'.',','))
str_replace(tasa_incidencia_acumulada_activos_ultimos_14dias,'.',',')
str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,'.',',')
str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,".","","")
str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,".",",")
str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,",",".")
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_ultimos_14dias,'.',','))
str_replace(DF$tasa_incidencia_acumulada_activos_ultimos_14dias,".",",")
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_ultimos_14dias,'.',','))
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_ultimos_14dias,'.',','))
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'))
str_replace(DF$tasa_incidencia_acumulada_ultimos_14dias,",",".")
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(tasa_incidencia_acumulada_ultimos_14dias = str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'))
DF <- DF0
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'),
tasa_incidencia_acumulada_total=str_replace(tasa_incidencia_acumulada_total,',','.'),
=str_replace(,',','.')
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.')
)
DF <- DF0
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.')
)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.')
)
DF['tasa_incidencia_acumulada_ultimos_14dias']
tasa_incidencia_acumulada_ultimos_14dias
DF['tasa_incidencia_acumulada_ultimos_14dias']
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'),
tasa_incidencia_acumulada_ultimos_14dias=as.numeric(tasa_incidencia_acumulada_ultimos_14dias)
)
DF['tasa_incidencia_acumulada_ultimos_14dias']
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>% select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1')
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>% select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1')
names(NewDF)['municipio_distrito'] <- 'MD'
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>% select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1')
names(NewDF)['municipio_distrito']
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>%
select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1') %>%
rename('municipio_distrito'= 'MD',
'tasa_incidencia_acumulada_ultimos_14dias' = 'TIA14')
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>%
select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1') %>%
rename('MD' = 'municipio_distrito',
'TIA14' = 'tasa_incidencia_acumulada_ultimos_14dias' )
View(NewDF)
View(NewDF)
View(DF)
View(DF)
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 = '2020-10-27')
#Calculo el decil 10
NewDF10 <- NewDF %>% select(FI1 = '2020-10-27')
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27')
View(NewDF10)
View(NewDF10)
#Calculo el decil 10
quantile( filter(NewDF,NewDF$FI1 == '2020-10-27'),10)
#Calculo el decil 10
NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
#Calculo el decil 10
quantile(NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14),10)
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
quantile(NewDF10,0.10)
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
quantile(NewDF10,c(0.10))
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
quantile(NewDF10$TIA14,c(0.10))
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
quantile(NewDF10$TIA14,c(0.90))
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
decil10 <- quantile(NewDF10$TIA14,c(0.90))
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10)
)
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
)
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) %>%
select('TIA14')
ggplot(data=MDDecil10)+ geom_line(x=TIA14,y=FI1)
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) %>%
## select('TIA14')
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
ggplot(data=MDDecil10)+ geom_line(x=TIA14,y=FI1)
ggplot(data=MDDecil10)+ geom_line(x='TIA14',y='FI1')
ggplot(data=MDDecil10)
ggplot(data=MDDecil10)+ geom_line(x='TIA14',y='FI1')
View(MDDecil10)
ggplot(data=MDDecil10)+ geom_line(x=TIA14,y=FI1)
ggplot(data=MDDecil10)+ geom_line(x='TIA14',y=FI1)
ggplot(data=MDDecil10)+ geom_line(x='TIA14',y='FI1')
ggplot(data=MDDecil10,aes(x='TIA14',y='FI1'))
ggplot(data=MDDecil10,aes(x='TIA14',y='FI1')) +geom_line()
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
ggplot(data=DFSoloDecil10,aes(x='TIA14',y='FI1')) +geom_line()
View(DFSoloDecil10)
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- DF %>% filter(MD %in% MDDecil10$MD)
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
DF[x,'M'] <- month(DF[x,'FI1'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'),
tasa_incidencia_acumulada_ultimos_14dias=as.numeric(tasa_incidencia_acumulada_ultimos_14dias)
)
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>%
select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1','M') %>%
rename('MD' = 'municipio_distrito',
'TIA14' = 'tasa_incidencia_acumulada_ultimos_14dias' )
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
decil10 <- quantile(NewDF10$TIA14,c(0.90))
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
ggplot(data=DFSoloDecil10,aes(x='TIA14',y='FI1')) +geom_line()
ggplot(data=DFSoloDecil10,aes(x='TIA14',y='M')) +geom_line()
View(DFSoloDecil10)
View(DFSoloDecil10)
ggplot(data=DFSoloDecil10,aes(x='TIA14',y='M'))
ggplot(data=DFSoloDecil10,aes(x='TIA14',y='M')) +geom_line(linetype = 'dashed')
ggplot(data=DFSoloDecil10,aes(y='TIA14',m='M')) +geom_line(linetype = 'dashed')
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='M')) +geom_line(linetype = 'dashed')
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
DFSoloDecil10
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
library(tidyverse)
library(lubridate)
library(stringr)
## Carga del fichero
DF0 <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
DF0.
DF <- DF0
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
DF[x,'M'] <- month(DF[x,'FI1'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'),
tasa_incidencia_acumulada_ultimos_14dias=as.numeric(tasa_incidencia_acumulada_ultimos_14dias)
)
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>%
select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1','M') %>%
rename('MD' = 'municipio_distrito',
'TIA14' = 'tasa_incidencia_acumulada_ultimos_14dias' )
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
decil10 <- quantile(NewDF10$TIA14,c(0.90))
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line(linetype = 'dashed')
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line(linetype = 'dashed')
library(tidyverse)
library(lubridate)
library(stringr)
## Carga del fichero
DF0 <- read.csv('https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv',sep = ';')
DF <- DF0
## convierto las fechas, no consigo convertir la columna entera así que lo hago fila a fila.
for (x in 1:nrow(DF)){
DF[x,'FI1'] <- date(DF[x,'fecha_informe'])
DF[x,'M'] <- month(DF[x,'FI1'])
}
# Transformo el campo `tasa_incidencia_acumulada_ultimos_14dias` en numerico, para ello reemplazo las `,` por `.`
DF <- DF %>% mutate(
tasa_incidencia_acumulada_ultimos_14dias=str_replace(tasa_incidencia_acumulada_ultimos_14dias,',','.'),
tasa_incidencia_acumulada_ultimos_14dias=as.numeric(tasa_incidencia_acumulada_ultimos_14dias)
)
# hago un nuevo dataframe y renombro las columnas para que sea más fácil de manipular
NewDF <- DF %>%
select('municipio_distrito','tasa_incidencia_acumulada_ultimos_14dias','FI1','M') %>%
rename('MD' = 'municipio_distrito',
'TIA14' = 'tasa_incidencia_acumulada_ultimos_14dias' )
#Calculo el decil 10
NewDF10 <- NewDF %>% filter(FI1 == '2020-10-27') %>% select (TIA14)
decil10 <- quantile(NewDF10$TIA14,c(0.90))
## Extraigo la lista de distritos que incluye el decil
MDDecil10 <- NewDF %>% filter(FI1 == '2020-10-27',
TIA14>=decil10
) ## %>% select('TIA14')
DFSoloDecil10 <- NewDF %>% filter(MD %in% MDDecil10$MD)
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line(linetype = 'dashed')
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line(linetype = 'dashed')
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line(linetype = 'red')
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1')) +geom_line()
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_line()
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_line()
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='M'))+geom_line()
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='M'))+geom_point()
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
DFSoloDecil10
DFSoloDecil10$FI1 <-
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
DFSoloDecil10$FI1 <-
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
####Ejercicio Extra Los 21 distritos de Madrid y las distintas poblaciones de la Comunidad tienen una Tasa de Incidencia Acumulada del COVID-19 en los últimos 15 días de un determinado valor. Cada semana la Comunidad de Madrid pubblica dichos datos en formato csv en el Portal de Datos Abiertos.
Los datos se encuentran en la dirección: https://datos.comunidad.madrid/catalogo/dataset/7da43feb-8d4d-47e0-abd5-3d022d29d09e/resource/f22c3f43-c5d0-41a4-96dc-719214d56968/download/covid19_tia_muni_y_distritos_s.csv
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
DFSoloDecil10
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
as.factor(DFSoloDecil10)
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
as.factor(DFSoloDecil10$FI1)
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
as.factor(DFSoloDecil10$FI1)
DFSoloDecil10$FI1
DFSoloDecil10$FI1 <- as.factor(DFSoloDecil10$FI1)
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
DFSoloDecil10$FI1
DFSoloDecil10$FI1 <- as.factor(DFSoloDecil10$FI1)
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
# Lanzo el gráfico con ggplot pero no consigo trazar nada
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
max(FI1)
# Lanzo el gráfico con ggplot pero no consigo trazar nada
ggplot(data=DFSoloDecil10,aes(y='TIA14',x='FI1'))+geom_point()
max(DFSoloDecil10$FI1)
